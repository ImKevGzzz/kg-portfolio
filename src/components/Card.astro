---
import DrupalIcon from "../Icons/TechnologiesIcons/DrupalIcon.astro";
import NextJsIcon from "../Icons/TechnologiesIcons/NextJsIcon.astro";
import FigmaIcon from "../Icons/TechnologiesIcons/FigmaIcon.astro";
import GatbsyJsIcon from "../Icons/TechnologiesIcons/GatsbyJsIcon.astro";
import GrapgQLIcon from "../Icons/TechnologiesIcons/GraphQLIcon.astro";
import AstroJsIcon from "../Icons/TechnologiesIcons/AstroJsIcon.astro";
import ProjectImage1 from "../../public/projectsImages/Project1.webp";
import ProjectImage2 from "../../public/projectsImages/Project2.webp";
import ProjectImage3 from "../../public/projectsImages/Project3.webp";
import CardSvg from "../Icons/CardSvg.astro";
import { getI18n } from "@src/i18n";

const {currentLocale} = Astro;
const i18n = getI18n({currentLocale});

const icons = {
    Project1: {
        techIcons: {
            drupalIcon: DrupalIcon,
            nextIcon: NextJsIcon,
            figmaIcon: FigmaIcon,
        }
    },
    Project2: {
        techIcons: {
            drupalIcon: DrupalIcon,
            gatsbyIcon: GatbsyJsIcon,
            graphQLIcon: GrapgQLIcon,
        }
    },
    Project3: {
        techIcons: {
            astroIcon: AstroJsIcon,
            figmaIcon: FigmaIcon,
        }
    }
}

const CARDS_DATA = i18n.PROJECTS.CARDS.map((card, index) => {
    return {
        ...card,
        CARD_IMAGE: index === 0 ? ProjectImage1 : index === 1 ? ProjectImage2 : ProjectImage3 ,
        TAG_ICONS: icons[`Project${index + 1}`].techIcons
    }
})
---

<section class="mt-14">
    {CARDS_DATA.map(({ CARD_TITLE, CARD_DESCRIPTION_N1, CARD_DESCRIPTION_N2, CARD_URL,TAG_ICONS, CARD_IMAGE, CARD_IMG_ALT }) => (
        <article class="dark:bg-lightModeExperienceHover dark:bg-opacity-[10%] bg-darkModeColor bg-opacity-[70%] duration-200 hover:shadow-[0_4px_50px_0px_rgba(0,0,0,0.4)] rounded-2xl h-full flex flex-col justify-between cursor-pointer" redirect-url={CARD_URL}>
            <img src={CARD_IMAGE.src} class="p-2 rounded-[19px]" alt={CARD_IMG_ALT}/>
            <div class="px-5 gap-y-5 flex flex-col mt-4 mb-5 flex-grow">
                <h4 class="dark:text-lightModeExperienceHover font-bold text-[20px] leading-6 text-lightTagIconColor">{CARD_TITLE}</h4>
                <div class="flex flex-col gap-y-2 flex-grow">
                    <p class="text-white text-base font-medium">{CARD_DESCRIPTION_N1}</p>
                    <p class="text-white text-base font-medium">{CARD_DESCRIPTION_N2}</p>
                </div>
                <div class="items-center justify-between flex">
                    <div class="flex gap-2">
                        {Object.keys(TAG_ICONS).map(key => {
                            const Icon = TAG_ICONS[key];
                            return (
                                <div class="bg-tagsBgColor bg-opacity-[9%] p-2 rounded-[10px]">
                                    <Icon class="h-5 w-5 dark:fill-darkModeOrange fill-lightTagIconColor" />
                                </div>
                            );
                        })}
                    </div>
                    <CardSvg class="cardSvg dark:stroke-darkModeOrange stroke-lightTagIconColor"/>
                </div>
            </div>
        </article>
    ))}
</section>

<script>
    document.querySelectorAll("article").forEach(article => {
        article.addEventListener("click", () => {
            const pageUrl = article.getAttribute("redirect-url");
            if (pageUrl) {
                window.open(pageUrl,'_blank');
            }
        });
    });
</script>

<style>
    section {
        column-gap: 60px;
        display: grid;
        grid-template-columns: repeat(2, 435px);
        justify-content: center;
        row-gap: 40px;
    }

    article:nth-child(3n) {
        display: grid;
        grid-auto-flow: dense;
        grid-column: span 2;
        grid-template-columns: repeat(2, 454px);
    }

    article:nth-child(3n) > img {
        height: 332px;
        object-fit: cover;
    }

    article:nth-child(3n) > img:nth-child(1) {
        grid-column-start: 2;
    }

    article > img {
        display: block;
        transition: 300ms ease;
        width: 100%;
    }

    article:hover {
        transform: translateY(10px);
    }

    article div > div > .cardSvg {
        transform: rotate(0deg) scale(0);
        transition: transform 0.3s ease;
    }

    article:hover div > div > .cardSvg {
        transform: rotate(135deg) scale(1);
    }
</style>